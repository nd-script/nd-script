{
  "$schema": "https://raw.githubusercontent.com/martinring/tmlanguage/master/tmlanguage.json",
  "name": "ND-Script",
  "scopeName": "source.ndscript",
  "patterns": [
    {
      "include": "#comments"
    },
    {
      "include": "#strings"
    },
    {
      "include": "#numbers"
    },
    {
      "include": "#imports"
    },
    {
      "include": "#keywords"
    },
    {
      "include": "#operators"
    },
    {
      "include": "#functions"
    },
    {
      "include": "#variables"
    },
    {
      "include": "#punctuation"
    },
    {
      "include": "#control"
    }
  ],
  "repository": {
    "imports": {
      "patterns": [
        {
          "name": "meta.import.simple.ndscript",
          "match": "\\b(استيراد|import)\\s+(\"[^\"]+\")",
          "captures": {
            "1": {"name": "keyword.control.advanced.ndscript"},
            "2": {"name": "string.quoted.double.ndscript"}
          }
        },
        {
          "name": "meta.import.namespace.ndscript",
          "match": "\\b(استيراد|import)\\s+(\"[^\"]+\")\\s+(كـ|as)\\s+([a-zA-Z_\\u0600-\\u06FF][a-zA-Z0-9_\\u0600-\\u06FF]*)",
          "captures": {
            "1": {"name": "keyword.control.advanced.ndscript"},
            "2": {"name": "string.quoted.double.ndscript"},
            "3": {"name": "keyword.control.advanced.ndscript"},
            "4": {"name": "variable.other.alias.ndscript"}
          }
        },
        {
          "name": "meta.import.selective.ndscript",
          "match": "\\b(من|from)\\s+(\"[^\"]+\")\\s+(استيراد|import)\\s+([a-zA-Z_\\u0600-\\u06FF][a-zA-Z0-9_\\u0600-\\u06FF,،\\s]*)",
          "captures": {
            "1": {"name": "keyword.control.advanced.ndscript"},
            "2": {"name": "string.quoted.double.ndscript"},
            "3": {"name": "keyword.control.advanced.ndscript"},
            "4": {"name": "variable.other.imported.ndscript"}
          }
        }
      ]
    },
    "comments": {
      "patterns": [
        {
          "name": "comment.line.double-slash.ndscript",
          "begin": "//",
          "end": "$"
        },
        {
          "name": "comment.block.ndscript",
          "begin": "/\\*",
          "end": "\\*/"
        }
      ]
    },
    "strings": {
      "patterns": [
        {
          "name": "string.quoted.double.ndscript",
          "begin": "\"",
          "end": "\"",
          "patterns": [
            {
              "name": "constant.character.escape.ndscript",
              "match": "\\\\."
            }
          ]
        },
        {
          "name": "string.quoted.single.ndscript",
          "begin": "'",
          "end": "'",
          "patterns": [
            {
              "name": "constant.character.escape.ndscript",
              "match": "\\\\."
            }
          ]
        }
      ]
    },
    "numbers": {
      "patterns": [
        {
          "name": "constant.numeric.float.ndscript",
          "match": "\\b\\d+\\.\\d+\\b"
        },
        {
          "name": "constant.numeric.integer.ndscript",
          "match": "\\b\\d+\\b"
        }
      ]
    },
    "keywords": {
      "patterns": [
        {
          "name": "keyword.control.command.ndscript",
          "match": "\\b(تهيئة|init|تطور|evolve|عرض|show|ضبط|set|حفظ|save|تحميل|load|خروج|exit)\\b"
        },
        {
          "name": "keyword.control.advanced.ndscript",
          "match": "\\b(دالة|function|ماكرو|macro|استيراد|import|من|from|كـ|as)\\b"
        },
        {
          "name": "keyword.control.conditional.ndscript",
          "match": "\\b(إذا|if|وإلا|else|وإلا_إذا|elif)\\b"
        },
        {
          "name": "keyword.control.loop.ndscript",
          "match": "\\b(كرر|for|بينما|while|طالما|في|in|توقف|break|استمر|continue|موازي|parallel)\\b"
        },
        {
          "name": "keyword.control.flow.ndscript",
          "match": "\\b(إرجاع|return)\\b"
        },
        {
          "name": "keyword.control.debug.ndscript",
          "match": "\\b(تشخيص|debug|تحليل_أداء|profile)\\b"
        },
        {
          "name": "storage.type.ndscript",
          "match": "\\b(رقم|number|نص|string|منطق|boolean|قائمة|list|كائن|object|فراغ|void)\\b"
        },
        {
          "name": "keyword.other.parameter.ndscript",
          "match": "\\b(عمق|depth|حجم|size|أبعاد|dimensions|خطوات|steps|سرعة|speed|وقت|time)\\b"
        },
        {
          "name": "keyword.other.physics.ndscript",
          "match": "\\b(عدم_انتظام|irregularity|عتبة_انهيار|collapse_threshold|جاذبية|gravity|كتلة|mass|طاقة_كمية|quantum_energy)\\b"
        },
        {
          "name": "keyword.other.display.ndscript",
          "match": "\\b(كثافة|density|طاقة|energy|حالة|state|إحصائيات|stats|رسم|plot|تحليل|analysis)\\b"
        }
      ]
    },
    "operators": {
      "patterns": [
        {
          "name": "keyword.operator.comparison.ndscript",
          "match": "(==|!=|<=|>=|<|>)"
        },
        {
          "name": "keyword.operator.arithmetic.ndscript",
          "match": "(\\+|\\-|\\*|\\/|%)"
        },
        {
          "name": "keyword.operator.assignment.ndscript",
          "match": "="
        }
      ]
    },
    "functions": {
      "patterns": [
        {
          "name": "meta.function.definition.ndscript",
          "begin": "\\b(دالة|function)\\s+([a-zA-Z_\\u0600-\\u06FF][a-zA-Z0-9_\\u0600-\\u06FF]*)\\s*\\(",
          "beginCaptures": {
            "1": {"name": "keyword.control.advanced.ndscript"},
            "2": {"name": "entity.name.function.ndscript"}
          },
          "end": "\\)\\s*(:\\s*(رقم|number|نص|string|منطق|boolean|قائمة|list|كائن|object|فراغ|void|قائمة\\[[^\\]]+\\]|list\\[[^\\]]+\\]))?",
          "endCaptures": {
            "2": {"name": "storage.type.return.ndscript"}
          },
          "patterns": [
            {
              "name": "meta.parameter.ndscript",
              "match": "\\b([a-zA-Z_\\u0600-\\u06FF][a-zA-Z0-9_\\u0600-\\u06FF]*)\\s*(:\\s*(رقم|number|نص|string|منطق|boolean|قائمة|list|كائن|object|فراغ|void|قائمة\\[[^\\]]+\\]|list\\[[^\\]]+\\]))?",
              "captures": {
                "1": {"name": "variable.parameter.ndscript"},
                "3": {"name": "storage.type.parameter.ndscript"}
              }
            },
            {
              "name": "punctuation.separator.parameter.ndscript",
              "match": "[,،]"
            }
          ]
        },
        {
          "name": "meta.macro.definition.ndscript",
          "begin": "\\b(ماكرو|macro)\\s+([a-zA-Z_\\u0600-\\u06FF][a-zA-Z0-9_\\u0600-\\u06FF]*)\\s*\\(",
          "beginCaptures": {
            "1": {"name": "keyword.control.advanced.ndscript"},
            "2": {"name": "entity.name.function.macro.ndscript"}
          },
          "end": "\\)",
          "patterns": [
            {
              "name": "variable.parameter.ndscript",
              "match": "\\b[a-zA-Z_\\u0600-\\u06FF][a-zA-Z0-9_\\u0600-\\u06FF]*\\b"
            },
            {
              "name": "punctuation.separator.parameter.ndscript",
              "match": "[,،]"
            }
          ]
        },
        {
          "name": "entity.name.function.call.ndscript",
          "match": "\\b([a-zA-Z_\\u0600-\\u06FF][a-zA-Z0-9_\\u0600-\\u06FF]*)\\s*(?=\\()"
        },
        {
          "name": "entity.name.function.builtin.ndscript",
          "match": "\\b(كثافة|density|طاقة|energy|حالة|state|إحصائيات|stats|رسم|plot|تحليل|analysis)\\b"
        },
        {
          "name": "entity.name.function.builtin.math.ndscript",
          "match": "\\b(sin|cos|tan|sqrt|log|exp|abs|min|max|round|len|floor|ceil|pow|جذر|لوغ|أس|مطلق|أدنى|أعلى|أرضية|سقف|قوة)\\b"
        }
      ]
    },
    "variables": {
      "patterns": [
        {
          "name": "meta.variable.declaration.ndscript",
          "match": "\\b([a-zA-Z_\\u0600-\\u06FF][a-zA-Z0-9_\\u0600-\\u06FF]*)\\s*(:\\s*(رقم|number|نص|string|منطق|boolean|قائمة|list|كائن|object|فراغ|void|قائمة\\[[^\\]]+\\]|list\\[[^\\]]+\\]))\\s*=",
          "captures": {
            "1": {"name": "variable.other.ndscript"},
            "3": {"name": "storage.type.ndscript"}
          }
        },
        {
          "name": "constant.numeric.mathematical.ndscript",
          "match": "\\b(π|pi|e|φ|phi|c|h|ħ|hbar|∞|infinity|τ|tau)\\b"
        },
        {
          "name": "constant.language.boolean.ndscript",
          "match": "\\b(true|false|صحيح|خطأ|نعم|لا)\\b"
        },
        {
          "name": "constant.language.null.ndscript",
          "match": "\\b(null|فارغ|لا_شيء)\\b"
        },
        {
          "name": "variable.other.ndscript",
          "match": "\\b[a-zA-Z_\\u0600-\\u06FF][a-zA-Z0-9_\\u0600-\\u06FF]*\\b"
        }
      ]
    },
    "punctuation": {
      "patterns": [
        {
          "name": "punctuation.separator.ndscript",
          "match": "[,;]"
        },
        {
          "name": "punctuation.section.brackets.ndscript",
          "match": "[\\[\\]\\(\\)\\{\\}]"
        },
        {
          "name": "punctuation.definition.string.ndscript",
          "match": "[\"']"
        }
      ]
    },
    "control": {
      "patterns": [
        {
          "name": "punctuation.separator.colon.ndscript",
          "match": ":"
        },
        {
          "name": "keyword.operator.range.ndscript",
          "match": "\\.\\."
        }
      ]
    }
  }
}
